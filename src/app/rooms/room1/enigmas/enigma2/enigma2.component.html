<div class="enigma2-container">
  <div class="enigma-header">
    <h2>√ânigme 2 : Trouve la couleur</h2>
    <button class="hint-btn" (click)="toggleHint()">{{ showHint() ? '‚úï' : 'üí°' }} Indice</button>
  </div>

  @if (showHint()) {
  <div class="hint-box">
    <p>Explorez les zones noires pour d√©couvrir les couleurs cach√©es...</p>
    <p>Utilisez les codes hexad√©cimaux pour reconstituer la couleur finale.</p>
    <p>üí° Astuce : Le # est obligatoire dans votre r√©ponse !</p>
  </div>
  }

  <!-- Conteneur principal avec les deux zones -->
  <div class="main-zones-container">
    <!-- Zone rouge (2/3) -->
    <div
      class="red-zone"
      (mousemove)="onRedZoneMouseMove($event)"
      [style.--mouse-x.px]="redZoneMouseX()"
      [style.--mouse-y.px]="redZoneMouseY()"
    >
      <div class="color-overlay"></div>
      @if (redDiscovered()) {
        <div class="color-info">
          <p class="hex-code">{{getRedHex()}}</p>
        </div>
      }
    </div>

    <!-- Zone jaune (1/3) -->
    <div
      class="yellow-zone"
      (mousemove)="onYellowZoneMouseMove($event)"
      [style.--mouse-x.px]="yellowZoneMouseX()"
      [style.--mouse-y.px]="yellowZoneMouseY()"
    >
      <div class="color-overlay"></div>
      @if (yellowDiscovered()) {
        <div class="color-info">
          <p class="hex-code">{{getYellowHex()}}</p>
        </div>
      }
    </div>
  </div>

  <!-- Section de m√©lange des couleurs -->
  <div class="color-mixer-section">
    <div class="color-result-container">
      <div class="color-result-box" [style.background-color]="getMixedColor()"></div>
      <p class="hex-display">{{getHexColor()}}</p>
    </div>

    <div class="color-slider-container">
      <div class="slider-group">
        <label for="red-slider">Rouge ({{redValue()}})</label>
        <input
          type="range"
          id="red-slider"
          min="0"
          max="255"
          [value]="redValue()"
          (input)="updateRedValue($event)"
          class="color-slider red-slider"
        />
      </div>

      <div class="slider-group">
        <label for="green-slider">Vert ({{greenValue()}})</label>
        <input
          type="range"
          id="green-slider"
          min="0"
          max="255"
          [value]="greenValue()"
          (input)="updateGreenValue($event)"
          class="color-slider green-slider"
        />
      </div>

      <div class="slider-group">
        <label for="blue-slider">Bleu ({{blueValue()}})</label>
        <input
          type="range"
          id="blue-slider"
          min="0"
          max="255"
          [value]="blueValue()"
          (input)="updateBlueValue($event)"
          class="color-slider blue-slider"
        />
      </div>
    </div>
  </div>

  <!-- Section de guess -->
  <div class="guess-section">
    <h3>üéØ Devinez la couleur finale</h3>
    <p class="instructions">Entrez le code hexad√©cimal de la couleur qui combine les deux zones d√©couvertes :</p>
    
    <div class="input-group">
      <input 
        type="text" 
        [(ngModel)]="colorGuess"
        placeholder="#DF986C"
        class="color-input"
        [class.error]="attemptFailed()"
        (keyup.enter)="onGuessSubmit()"
      />
      <button 
        class="submit-btn"
        (click)="onGuessSubmit()"
        [disabled]="!colorGuess()"
      >
        Valider
      </button>
    </div>

    @if (attemptFailed()) {
      <div class="error-message">
        ‚ùå Ce n'est pas la bonne couleur. R√©essayez !
      </div>
    }

    @if (redDiscovered() && yellowDiscovered()) {
      <div class="hint-after-reveal">
        üí° Vous avez d√©couvert les composantes : {{getRedHex()}} + {{getYellowHex()}} = ?
      </div>
    }
  </div>
</div>
